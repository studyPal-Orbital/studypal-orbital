{"ast":null,"code":"import _objectSpread from \"/Users/ongyongen/Desktop/studyPal-local/studyPal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/ongyongen/Desktop/studyPal-local/studyPal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/ongyongen/Desktop/studyPal-local/studyPal/src/components/Forum/Comments.js\";\n\nimport React from 'react';\nimport { useState, useEffect } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { db } from \"../../firebase\";\nimport { UserAuth } from '../../context/AuthContext';\nimport { collection, query, onSnapshot, doc, updateDoc, deleteDoc, QuerySnapshot, orderBy, where } from \"firebase/firestore\";\nimport { useLocation } from 'react-router-dom';\nimport CreateComment from './CreateComment';\nimport Comment from './Comment';\nimport './Comments.css';\n\nvar Comments = function Comments() {\n  var _UserAuth = UserAuth(),\n      user = _UserAuth.user;\n\n  var location = useLocation();\n  var id = location.state.id;\n  var comments = location.state.comments;\n  var email = location.state.email;\n  var postTitle = location.state.title;\n  var postBody = location.state.body;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentComments = _useState2[0],\n      setCurrentComments = _useState2[1];\n\n  useEffect(function () {\n    var active = true;\n\n    if (active == true && user.uid != null) {\n      var q = query(collection(db, \"comments\"), where(\"postID\", \"==\", id), orderBy('createdAt'));\n      console.log(\"Retrieving comments list\");\n      var getAllComments = onSnapshot(q, function (querySnapshot) {\n        var comments = [];\n        querySnapshot.forEach(function (doc) {\n          comments.push(_objectSpread({}, doc.data(), {\n            id: doc.id\n          }));\n        });\n        setCurrentComments(function () {\n          return comments;\n        });\n      });\n      return function () {\n        active = false;\n      };\n    }\n  }, [user.uid]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"comments-container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }, postTitle), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }\n  }, postBody), /*#__PURE__*/React.createElement(NavLink, {\n    className: \"back-to-home-page-from-comments\",\n    to: \"/achievements\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }\n  }, \"Back\"), /*#__PURE__*/React.createElement(CreateComment, {\n    post: id,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ClassName: \"current-comments-container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }, currentComments.map(function (item) {\n    return /*#__PURE__*/React.createElement(Comment, {\n      comment: item.comment,\n      email: item.email,\n      className: \"current-comments\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }\n    });\n  })));\n};\n\nexport default Comments;","map":{"version":3,"names":["React","useState","useEffect","NavLink","db","UserAuth","collection","query","onSnapshot","doc","updateDoc","deleteDoc","QuerySnapshot","orderBy","where","useLocation","CreateComment","Comment","Comments","user","location","id","state","comments","email","postTitle","title","postBody","body","currentComments","setCurrentComments","active","uid","q","console","log","getAllComments","querySnapshot","forEach","push","data","map","item","comment"],"sources":["/Users/ongyongen/Desktop/studyPal-local/studyPal/src/components/Forum/Comments.js"],"sourcesContent":["import React from 'react'\nimport { useState, useEffect } from 'react'\nimport { NavLink } from 'react-router-dom'\n\nimport { db } from \"../../firebase\"\n    \nimport { UserAuth } from '../../context/AuthContext'\n\nimport {\n    collection,\n    query,\n    onSnapshot,\n    doc,\n    updateDoc,\n    deleteDoc,\n    QuerySnapshot,\n    orderBy, \n    where\n    } from \"firebase/firestore\"\n\nimport { useLocation } from 'react-router-dom';\n\nimport CreateComment from './CreateComment'\nimport Comment from './Comment'\n\nimport './Comments.css'\n\nconst Comments = () => {\n\n    const {user}  = UserAuth()\n\n    const location = useLocation()\n    const id  = location.state.id\n    const comments = location.state.comments\n    const email = location.state.email\n    const postTitle = location.state.title\n    const postBody = location.state.body\n\n    const [currentComments, setCurrentComments] = useState([])\n\n    useEffect(() => {\n      let active = true\n      if (active == true && user.uid != null) {\n        const q = query(collection(db, \"comments\"), where (\"postID\", \"==\", id), orderBy('createdAt'))\n        console.log(\"Retrieving comments list\")\n        const getAllComments = onSnapshot(q, (querySnapshot) => {\n          let comments = []\n          querySnapshot.forEach((doc) => {\n            comments.push({...doc.data(), id: doc.id})\n          })\n          setCurrentComments(() => comments)\n        })\n        return () => {active = false}}\n      }, [user.uid])\n\n    return (\n        <div className=\"comments-container\">\n            <p>{postTitle}</p>\n            <p>{postBody}</p>\n            <NavLink className=\"back-to-home-page-from-comments\" to='/achievements'>\n                    Back        \n            </NavLink>\n            <CreateComment \n              post={id}\n            />\n            <div ClassName=\"current-comments-container\">\n              {currentComments.map((item) => (\n                <Comment \n                  comment={item.comment}\n                  email={item.email}\n                  className=\"current-comments\"\n                />\n              ))}\n            </div>\n        </div>\n    )\n\n}\n\nexport default Comments;"],"mappings":"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"},"metadata":{},"sourceType":"module"}